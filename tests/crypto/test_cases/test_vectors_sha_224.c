/*
 * Copyright (c) 2019 Nordic Semiconductor ASA
 *
 * SPDX-License-Identifier: LicenseRef-BSD-5-Clause-Nordic
 */

#include <stdio.h>
#include <stdarg.h>
#include <string.h>
#include <stddef.h>

#include "common_test.h"
#include <mbedtls/md.h>

/**@brief SHA test vectors can be found on NIST web pages.
 *
 * https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Secure-Hashing
 */
const char flash_data_sha_224[4096] = { "1234567890" };

/* SHA224 - Based on NIST CAVS 11.0 */
ITEM_REGISTER(test_vector_hash_224_data,
	      test_vector_hash_t test_vector_SHA224_invalid) = {
	.digest_type = MBEDTLS_MD_SHA224,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_FAIL,
	.p_test_vector_name = TV_NAME("SHA224 invalid hash"),
	.p_input =
		"934416dd0581e22f2bfbece7bb64afe820451fa21342df7e6f9fb37c4103381a1f7cd379bcc4",
	.p_expected_output =
		"8f34812d57a16ef8a51ad987660c5f8623e0fa9d89846e28d46d14d9"
};

/* SHA224 - NIST CAVS 11.0 */
ITEM_REGISTER(test_vector_hash_224_data,
	      test_vector_hash_t test_vector_SHA224_0) = {
	.digest_type = MBEDTLS_MD_SHA224,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.p_test_vector_name = TV_NAME("SHA224 message_len=0"),
	.p_input = "",
	.p_expected_output =
		"d14a028c2a3a2bc9476102bb288234c415a2b01f828ea62ac5b3e42f"
};

/* SHA224 - NIST CAVS 11.0 */
ITEM_REGISTER(test_vector_hash_224_data,
	      test_vector_hash_t test_vector_SHA224_2) = {
	.digest_type = MBEDTLS_MD_SHA224,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.p_test_vector_name = TV_NAME("SHA224 message_len=2"),
	.p_input = "5c7b",
	.p_expected_output =
		"daff9bce685eb831f97fc1225b03c275a6c112e2d6e76f5faf7a36e6"
};

/* SHA224 - NIST CAVS 11.0 */
ITEM_REGISTER(test_vector_hash_224_data,
	      test_vector_hash_t test_vector_SHA224_8) = {
	.digest_type = MBEDTLS_MD_SHA224,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.p_test_vector_name = TV_NAME("SHA224 message_len=8"),
	.p_input = "5f77b3664823c33e",
	.p_expected_output =
		"bdf21ff325f754157ccf417f4855360a72e8fd117d28c8fe7da3ea38"
};

/* SHA224 - NIST CAVS 11.0 */
ITEM_REGISTER(test_vector_hash_224_data,
	      test_vector_hash_t test_vector_SHA224_24) = {
	.digest_type = MBEDTLS_MD_SHA224,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.p_test_vector_name = TV_NAME("SHA224 message_len=24"),
	.p_input = "48d2f20955ea2d13433c20bc0404eb2e6ad79ed28f7cb4c0",
	.p_expected_output =
		"3617cc3179f8b59adce181eebeed5e2763f62650949224a67e53694b"
};

/* SHA224 - NIST CAVS 11.0 */
ITEM_REGISTER(test_vector_hash_224_data,
	      test_vector_hash_t test_vector_SHA224_32) = {
	.digest_type = MBEDTLS_MD_SHA224,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.p_test_vector_name = TV_NAME("SHA224 message_len=32"),
	.p_input = "fe1f0fb02c9011f4c8c5905934ed15136771737ce31c5859e67f235fe594f5f6",
	.p_expected_output =
		"bbeaacc632c2a3db2a9b47f157ab54aa27776c6e74cf0bcaa91b06d5"
};

/* SHA224 - NIST CAVS 11.0 */
ITEM_REGISTER(test_vector_hash_224_data,
	      test_vector_hash_t test_vector_SHA224_64) = {
	.digest_type = MBEDTLS_MD_SHA224,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.p_test_vector_name = TV_NAME("SHA224 message_len=64"),
	.p_input = "a3310ba064be2e14ad32276e18cd0310c933a6e650c3c754d0243c6c61207865b4b65248f66a08edf6e0832689a9dc3a2e5d2095eeea50bd862bac88c8bd318d",
	.p_expected_output =
		"b2a5586d9cbf0baa999157b4af06d88ae08d7c9faab4bc1a96829d65"
};

/* SHA224 - NIST CAVS 11.0 */
ITEM_REGISTER(test_vector_hash_224_data,
	      test_vector_hash_t test_vector_SHA224_757) = {
	.digest_type = MBEDTLS_MD_SHA224,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.p_test_vector_name = TV_NAME("SHA224 message_len=757"),
	.p_input = "51bcc9e9244e2fa1752c61e65aa5c592138447ef9287fdcb3b120bcfe825c50c308c14d7e9551bd7eb871a5c171192f29801aa3769f6d1e917d8a543c9c6138a7d50c0e394e7a867919106791ee27357502751f02be46af66981d53377401a20c17295b42feb207aefb3ece676feb0e9c15e06c3e1381119b6756447fb791ff782595bf3c148c9378e53954b274f91cf750f8f5792da0e7a881b1a265c5b6d364b6dda4753e8ecc7f5dbca4e3abb5d32f4a0b55646b1a94266ddbe79a2cd4b06a116da59ecb2d051acb1519ab62c5e39c47b406505a72a99d9221ae7d5b6008f0ebc22d0948ebffe3c3ff2d5a389da0d6f06f82ed8a3d8a66853f419fe00d5f819c77b555364fff62ceb77a809ba1ad57daba559c68efd929bd615b62592126a4b9fad90321cd960041fa6baf1a666ba74d10e8ed84edf84fa1445675054ff0c2aac8028389f95644d4249b4623706e4dedffc7415ccc6a50e754bd4892ee3074057bcc66ed37b2c8ebc263d6554417a423f37b385f0fc1d5e62f1a4d708088215062811daa1d3dd4ff406fe01e560a5295887f430a3c8137241fd8043cab4a62f228db286f1e4a21954b09e3ed3ab8c1a92b4df1fcb71afd37b380fd35c309b1814b3507aacf7a17243eec624046a589d55851b5951401b08796afa91a6c48858436294bdb85402e529861ebc61e5303a09c351e61e7d7c99a25be88591b7957516622556ff43eef76f414d0dd2643d7a163628cf1970fd0f5dd282b60353ecf9f77aad50680c8d327be7fc1f402ea6e4e5a6491b2960c3f11499702ce5deb26c4d74d1b0daf6061db640d2fb918c9401dcdb5bd23897f9c72e7659ef20a112547f163b803f4a8240881378a8afc62f57649c07fd2d5bc51a1332e5089ae4323bf72993c87e5128245a2a952e80249e70e6b3f5a2eff54f702a95bd7e3def3aa81c74808e7f502150924bd296eeed0ad4c8e6cccc68adc054dd668959f009532456c1abdc2a92944c9a3fd7e7e06b9a0974fe34807fca404b936ff0a19a7ba5360dd6bcb9675eaaa1d8ce4b293de4779950c3d7c8",
	.p_expected_output =
		"d2323cac073625fd6dd5d937cfa2d8bd01f75cb5afb15b7757dd8ac4"
};

/* SHA224 - NIST CAVS 11.0 */
ITEM_REGISTER(test_vector_hash_224_data,
	      test_vector_hash_t test_vector_SHA224_3133) = {
	.digest_type = MBEDTLS_MD_SHA224,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.p_test_vector_name = TV_NAME("SHA224 message_len=3133"),
	.p_input = 
		"2eb0eca524d5a152f51af240c51bd815f2d52bd9afbb64aeee06a7bb844c016a8754eed3fb291e78ae6d783261f0606b2881358e14041ebc0ec507c1060ce6464ef243474072f7c827c334c45de5c567b07b977d0ad87929525c20da8d016e7b4931f4ea3bdbb5ac27c52cdf0024916f516a598ddb5ffc5d7f73faef5f52207141ba07a33489df8b751b6a6993d24bedd2f681a8cdc02fc160b19ee9c5288490fd34875972a7fdccda6cf64c5e1a7c48fcc819b52a249abbbcbf13ae07ab2341474879f63e5b97d91e60d66ea922abe89788289b38b2c6b45a4461286d0284eae59ee761e0cd361909a014b9bc1260356bdeb74440933a1503e9913d3f5630f5a0ddd882a02761f462d4b813de1324973f70cd9789ee7e447f56aad7c4ceadc840ad5541c58ea1d2f3a4c866594d7d76dce9727c5dec1bab9632b4dd459385cd8db86586992c7d1b82b64e9973e7f63a0befaedb02b598b01026b8370acc3f6a4fa3103962297d37d8b551947509144b922a8a9cc1707dbdb4d9bccd5ba264094d195e4269ad298fbd47da3fa7dd611139440da8e24553394bf4cb87803d7b1150c05889f6df0a89f914f082508864f5cae240e5ad5da08c9d1eea4dc0c40cea204005f751e7a78e53c59b45b935a55d0baf293c6ae0ef1d720023076560a0fb85426e72c1ee88079402e3702b0aadb2c650d29560f6c55692417d9db538beae476e99e38f1c365a8472d1ebec2f035dc17043d9d8c5ac9ec58a01f7f975ee6a2d6b9033049838f1ebbe6c9e44cd2fc4c5b583ee1a782b5dd283b5fd783eb89800e25b48668b1632918ebd717d0cba5199c799be6e35cbfc82d3a3987cbca59e887a000cfd1c59873e88ca4dde132b6b074f90301c2412e19d23d3ae4b163ce58ddc896613748857b9579d18ae0b0a79d5f56d2b6b6f8a75eb1a4b282e7505d5d7affd3deeba2b09cba13ebc361be0e5cc603a99a53bbb20336115ef6d0189d62d9c657bd717cb073c0fb31fbe6c3316b439ff6110b32c4b3f9f39ea50e14f51594bc80716b3efb8d448062b8d268e745527c26bf4fc655cd57dbd001f3ee0ac21632ec9f3b51f845af53fc6ed70766776d38d9f9b41eebdbea3ab1b213fc2514e8da0a9b645e3d398bd64da24727557e1e467e54ca850d4c2b80a229f0d7fa6a870248fa68dc40d54497f4e7b5512ac5c0359254e59120ba865e3fce1cf9f15f6b5c5630cb2499a5740970a3a41d6ceb0d86947ea7dbcc93a513d932faea8050203880d30dffbe3694bb5f6a95d4726a50aa133683cd6753e2420ced1d224de920377755a3a604e5112e0fa10d2ef1a024209d110bde9797d8895950e629a076f5c9984d2eb0244d93c20feb6c756139127a80a29297c3cbf23a2d0308793ea61b7f620df1b692ec7727deae465027a186286c4fda71826cb9d52677d6896ee2fbc9732cbf21b72e45b00a6e2d47db5609aabe8d260449f6b9faa433e2e2b7ba31283a3dc97a27af8a0b01af83b4f2e3178205ff17c880f65d1b44aba00daf98362c2595b3386accbe8962f6ec2fe4b52a4ec0fa2226cde82da77653b072cd098535d3e90ed4d7224dcb8cb8b9314768dc517e22d7a79748a63fb7d076aa869aa8e5b39c2ee8133cd2320d798d31916a883aabfd9ad363a451349786752d72a81bac4313a5da9568c66d63cddad93926c88ac8defe32c967b936840a3e73f7ce480a11041634e452a4de0e0a2470c54a1792536b743e1f1f38a60bb03506ac89c88f9bd1d28f7676f7f48ad2fc90bc30f011da179f6dfb476a13ad3cfb6e0747279d42016d32c2422a5168acb5c19477dc69db67d24ae45cc80fd6f4e4027ea2bfc3a21768d76e40d66505ec028bd48b570ac5d0af3d40ebdceb176c917c99092b834a8837d5b0ff66b001354547f2e7da8537e6a8edb7511335ed288624ed06e56c99d87cc650da65c2d90d008e7629e169901e31b4be48f590d6ad34a3c11867d02e8c8a11c47e5e0e0bd7c6e7e4ae06186cebec3aac200e5c626f2f71dbaa3d6e5718f2507237a9f20829fabcb4f0a3122ce43ad82772c828fee2c9078358d087d21237fae0a2f42f5c782ea56d9e63076e7b9025a6bdbd672aacb3ed6e90cbccfdeced89965ca7167746e51a8513a0489026ae9bb06d58976421528be3ee89ae591d658519a14d37f71a908481dcf5563089c8b2cb0e144a39e5377b89ce849c62384265d13d51144a67b38bea76dcc0ddf980f35d1c9af02a7cc524c6bd6727a7a206b4536d5d2bffc2e099356db108e71a69e5ed153719a43cae2031378bc0a80f24e926ddbbff65909a24e91e3caeea40d6030184832745b934e64fc96d07d1b41f8cb1fb180f3a7532c77c24ba23662177c320e6f9c96d870bff88ffa55db35579178b31dbcbecc55ce9750dc3f6d920a1bed1b92550aa0a95d45326bf42cb57a402193e81b5db257b135a35e4a9b1c2f64e7a87705d89d864fd54eb0557983f32d4f26da47da3fa0fcd923996ac8e7ce80aa1be75506b54fbe304c921fc9870a8189d4bae53c5d7ad80b385548fddd2f96bedeaaec9ed24bd1dc92d9fb25a90664580552a08cf32b6d544a598c42e599cfa9578874a7dbc3b1638a4d9094d131fd4321681dd1e8fce23bc16edd9de75653f5f049922ab8ff854d9bb5871ee7d175d290c5071326356049055ce318ccac492910b4f02e514776202cdb87cbd32ff38dbb31045b941e0e047eeb47ba7ae4d9ce1e9336bb8ee3ac66a78539a47d93a0fd0873bcb01aff15f694e2b18bda452d6b84ac0cd9571a4ea6737c44b0cd44a4a9e055d91aa01f9ca7b00bc894d4196a88a9c7189194368569f88852f8ac8c2619ac9d00a10ec7cc9e382c35dc51a6bbaef5ae05ea2d7d78369e70088200b14ed6d214db4e4c3fcd63960ea06b37364663d02879ed0a385095cdfe1058b3fc4567bc82122843cfc67e3079af4a700f3332a2fc1ca113ae340eedf81282abb53354d0af4d37d9bfdf7870350d80e279aba0d3f3980e31294d2a6627b506d224402678623384f75642d7bd09601577bed637cbd5923c4aefc270a053a2ee0e9192641b656c1686dd14267ebe51121525db7ef36ab5344749bc690444814249435496207ea1f66c9c80ea1d1c877ea6f5e2fdb179a6fd117f639bf8c1f9086a83ac45f1767a2a93dbabad01ebab611177153d6ecc109f8ed9de90e594b24a5999c2f8f5149ebce1e2c0f692f364c43ef39ac593299923a89f56d03483550ffecdbf379422b6b340f8e54e38fc5bae15b0991d8659e9904618f2e14b578a604166cb8a366669189767423c5bcd37277ef83bceb124a9ee508ddb4d94d7f8440aae0d7a43aa60f2cd750148632fa1376111a75f7b518145ad46389c75cd48c341ebae8e23b44249cc6b47fab8ea41e7a64406584baa189e478b325458ff21e5ce66d54f3f4cb8267b913fdbc2c6be3e35d980428bf5170005a4f1ffa4372cb39967ab43fd3c6a90c22e0e72ea8bc144f6183ca4a2fb2574cfd89c24c13b11348a3658f4c64bff8f898bdf479600f102d2496306f884eb018d715c4c17d377708a1a03ea0340202bb8f1d8e32feef77fafb31cf0f55811af27b558fe0ec906707f5dd5ab1ae4746d38a621cd1e1d7ac4779f90eb013e3e8686edb9c20ee4673b5345f5c175ffa45ceff2e38dca5523d71055e77e84ff1a8f9060a6207feb42d9ec1b8bb47a595700c61f46ac9a5e9ac2641d4832e6634ed12e5848a1c9a73e533426c10a93b93662a57471b1f8ff868d593fdb8e8f328254491bc6cc54e004b011b0bd4d27e8e88975388d244b028f3ed902ca1ae7345d21c7f2492a885d3cf86dffa7049daf167d1cb4c18efa2d5edfcbb03a5e5731883f9225f941cee88d342f5ca8b85fd46847843036766f499b77168f55e345f0abb690fcfd9c8c479f6b3f0fe8f0d41f85ee93f31364111dee0fa4e843301a3a6d8fabbf7ec02b431ba585608e34645a167a334781e04873fdae5c022ccd3fd776d1c9b5a33714a4a9eae897c20c774bc2f44b72a8737c11735c262737431a8f6f84d4279588ae32f04353fbae0175bc3263c3bdafa415c0f621ea9d8c19152a00b1b35d7b3b60b599b7abd5779ac7730ecf8370bffc7b482e0690ad54d7976fd05f4e9f7ed894f44b4fd96d4860d338fd4172d3ff021771c512019fb706072788968d35c6e8b1b8af12c50b47da02d5a7bf7a2e983e4f03604e23bbdc2dcf1acf5e58667af31fc96d0857f79c90bc10b55482c8b1388cc5aac0df49ecd456104ec0977cc37f45ef2c397878700a6ab3cf0573ea7379378048721e900e8304d1adc332bdc8168df294ae0ed8ebd172849cdc33dc0688b6fce56cc6d96bc3412493701172b23f5e994e6e025d346c3e4cc5e0abe691ed730127b4c06c2a1b75d3a8cd1de2",
	.p_expected_output =
		"4784fc2495fd5a20178c7a8aa50686679138f54d4b9cba149269f191"
};

/* SHA224 - NIST CAVS 11.0 */
ITEM_REGISTER(test_vector_hash_224_data,
	      test_vector_hash_t test_vector_SHA224_4024) = {
	.digest_type = MBEDTLS_MD_SHA224,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.p_test_vector_name = TV_NAME("SHA224 message_len=4024"),
	.p_input = 
		"7e00aa080c127cbabfdfa5d9d9728c7b25358aecd26f5850810cc38a9d9da75deb9f1ad16200e8d93cdf40324d94ac8e94f046f210c52a5dd4a927aa5ef8bab725183cc771015a256ffcc60b85aa2cc1e34968095b33f6bb72a7a9adb7cca0d553f377b2e21dbae781bd9f2a28bff45c3bc856f95bc0a4b3828eb35a4f2243ff9eb932595c5cf0689aaa3357dfd8eca7c3f6798ab9741c8d2de4ac7acf018a7d2ef1d78588c7e4ede04cea5c52fffceaa45a39841d5746919a33fcd5de725d962a23cdfe0d657fc17e2a2d00283b0c6c057dffae2e720a07f2020a33257ca494bad87c8c953fa72b9acd620a0a9504760fe531d195cc51365cda405c4b2747bd08964cf7c55b45725dbbf3439f13cc50e91c39b5fa6d016701420517f97b2f5a39e8a50647c342dfee7e467390c04c42bdaa7d22035e04e208c2c12ed78142b27853ef83c37f84ba759ec56284a16d94b01567e05ba640ef9ae2dd678c40690feb619234e095f54b1ca1d6d724c0158dece75db6a84d9fd6df2bbf8bc1c08db7ba99f6e1470f7cd90911e39b18242d7699a7c96e935c08defe24d0621d0a94f30e838354a0f400ae6475537707d59e97dede12cec3da6250205678b34925680b0fa8a254924d6b1056568e3099dc4e38e413a09fe1cf97746c472048ec19ef47e48fb9a8c521a448073bfc91774027a1d3cedba894448e920b812ee7afef13efb6c13219e278939d9eac05614909101ad2982bb3853f2ff2248c0c593aaeba4aacc4736f915b205943311167b63ff0ea09f7f8865bcb62dce0ee2065345ecea1ef22e67279d033c22053886c67ebb15aa175aaebbfed0f976731d4d54608363ca662f1e943e2b4225a99d23804153ab2c29aa9a759af1e6ce0dc8f7017b3da63fa0dfe9e96968bbf1c8c579334c3733a93ed5d85d01877a37378b8fd5067a25e13aa74571bf6a0e28cb27f459fff44393df62f4ccd3003844a8cb945982c767418c1bbdd7a09dbd2d296b315eed095f9e73d85c3f700a8568aa0f910980b3eef31db3bf85ad725d917bd59cdc93f4ec0ba4bc8b4f78f4f635e3de025f70be215887f5b6f6369643d83b1db33d75257d7dea761e574e6e1f1ecead64e5e354a2f4235860c3ec682473df99f10c11398867ad9b61e170b44495c2f4351758f5f848a85219593f6653f6e1d0f2b2e8afa14b76a3129880862b3d7948ff7e324075e86f895d30902f76d3da5914ec7be63cbbce139cd6ee5217685a2220851f92b035e154a8e49f11e18d31a8f3f34b7bcf1b2c635d171a86bdc8de0654c6618b4bc3b64a88efbcbc48a570470c71c7deecfc0a28ffe3a5b272b17d6be8bcb8888d1456e189ac699d009f2e99cae2819e0ad0ffbae1c71053dac4d0d968c2751918aa3ba007c52622adecc537bbcff9279d3c65cfaf3beaf94a7550c5618237cb52f7ed1c9fa482eba510cc975b949f0a3880e4adb4ac7601664575b64f7670fde07fd39dcdd500568a9dbd4f26cb03b45150f4fb9ea3720aa2a7c832af19a15f35b497c9fec11f01c3060fb5a9eda7c46c2f0f2fc9cb4f73843eb0b0ecd6493dc7389217cf134f6be2cc4c615176fbb90d7dabc0c26e6eea9f5cd7b7a556f938197e6b1dab2602036e62ebd8b9f18fe0a9cf4335250770ce3894a5cd54f601cca0f88b321f93e756ca6c76924fe7d4f9c5967e134e40c5acf4789358784e2379f2296afb88c76fd48b4b65149fb45b52e555a4e1ba850de5576b38ef8bc9bebe81a382e0933afc0b35724fd60601839a8d9f6007066e8a25e5fefef90bf33408d3d98b77bb891c793d839f6d3f3a0e1f22d628199e47faed04b66e1b754533e76d4dbd276e2c619d27f1cc3087d82b7f599c75900ebbb08958040ebd545a3ee8b262c076278f3be5694f6ec69c569c397654d0e0b4244ba9347a4965258ca57b57db1dfa843c3bf095feefa5c95fb0cc1d81b2a24b3c3ccb4e7ba6996567181da1f92e1ae0bdb23d1282d744bb3e09a5c3b5a35b204e044deaaabec09063f75e355f896dd97e6f29836dbe29de8c1754ed631b51dfe422cfbd69fa71332dd3ab9670b849db18a3445d21fccbafc46a681f1c934cc69928bf2b4bd231da0f2d8429df235571f6ff2c04421bb0ab71634dbd44a39290d776aab8c2ee78d192758683fd63171aa3e34f1d40a37f5e1da2746c7db4d9bb19ad00ea61a7bcd6524c11294defe551a9f00c0ca02c6e3413987a911a4f78a1fa2c50349a868434c901b28e5332669373960156d30f23ca0dc5debfbcebf5e1d385272be00355996136f917afc3117c9b55bd806bd4268c66ab0f6cd812d8074047d434e4b6a760a56c4379b62a5c697baf9f1ddd03ecf7b8c89b1cfe4ca56ecad505e3eb1900172012201908d0cdd6af143483a926fd987eaef0448201d494cdcd3abd9592e6494bc91d7a0a4edc60a0240c5652b5cefb12bead7825caec25e380d13666ccc06382d1aa115cfd1e83f94f951a5c28e77c2f88212c3c10627e86a067c2c11f24f28ffc44735383fabd14f74d2447f8bdb83f8c09e5477ace1b319c6d0747129a72bd898b24904bf7787ddbb32888bdd81b9d4ab617da5285987ee56f586b3f87608619cc8985ed9b42ae3d657ba0e0bd32f334c44857403f62b91bdd5aa01e8248841da726c6c16ca820ccb2b212f9e37acbea92fb60bc41f69a903562880801973205a990b56fd2257fda49407171d17f71dcc0b5693f33e07de3162475a48be91a82323be4517227161697cb2ee10dad9f7bdbeae3319baceda4de051b7c879a97f3cfacd61ea3398de20ca6bdb00e81af482320614bdfb864262b78cbe89b3854db00480d100be931cd3667a0674a982bd254da65d6769f7c175d1419812d5ebbb842b1fbee1292bc489372798f485d8faaef9d5379f6ce8fd9015b76ceb45a470c255f14f13dd287e4b27bab908e4e652231ddccaee6c239eba6b38639d6d7815726c3fad204352f1201d7a90392e726e8ea1033ddbd16e4dfcbb0aa5afb42e529a5751ff90c270c61002b1460ecb45f6f66c92b8ef0392b25ded7659a98190ce44fe6f6ee9c14ca523bca502102327916468d165b06a5774e5eac4a8143e64327749e122b5aaac3462349eedc59ee0e7df7c086aa86e843b9c983cb9765273253c20ee427be4591ed452e62fb7a537a16f907eef5f78e3b18be026b55a2585509a6be0f6c4d71b0981ffc4ef6e9ef5671c8d7c1d5cee3a7cb9aac9c3451f625b9912fd6817ebb99e72217f5571f3e2e0ef594a1b273a52442edf6e0cc1a8d1ed41fd8ebdfc88fd84aea1608b480ac6b5efdd301248c2f3b2f3655db755289bae9b15da20fb16ad633d68afb67b4d698e2501762a47f0e46d0f26deed8a078848ae402bb79dfd92e5285db4019222931197ae638aad2bef1e8a0939d6e6ad60608267c7aa69a574b07667b69216f30be94fca405b02dada6d6df5b599f382eba12073f722e8771b6c2f70ff918f279abc553e55c4cc676e01bfd49b5f39eff1b08f4a0347a0d94ec25c5fd52783260833aff3eaee95397383888d334f3f5a3938d7d633401b34d759041c817c7c581df567d04701e4b8b19ad008c5928d2c8cdf01fdcf36e1f17cdb2f8e4ab70125a0ab85bcb424424cf0efa02d994fabceb24d14a91e50787606ede59f7a009bf55bfc0fa1787f365df72affe4f7af22a6732b18c169b76a2d3c392f365881d03014910f66dc3b48538ff2f61526da781e9721162df8923f7ce867143b2b5f2b3e94118cf32880009680ef8ca86ff7389de5d614d5130a7dcdd01f9d973cc53187a3258f30a475e78e92cac9851a2ee78a26f31da10247ae87bd08d130d3d96c7408751f05974384a48c2bb5946fa90f4f221f36790c70591278cab8ef37c3636b8da8445a4b115f3e38b959beb58d3753a10369457bad07d6c60e5abcb2ac9ed5f8660617060801c65c1dbce93605e8fe6b47bded95283f3b727cc0808abca61b12596e241150f1a2c1ffe6fe3836a9b847923b59a30689a942bbf121081a02a3a3278369b410b73c2f05e0e6044b02e9ff8ce971ec726d880074f58974ef3ad773784ece3671dcfa6edab187e26a7bf959ded11eba927440724ed59e1662d71e49f5d53ce19ae746452461cb19bc9d511e30fb46538e253961f2984a359c60dfef452299fbb360877d8cf999f368ef5716296dd2008f09db940746741bc45d842b113dcfcde6d024deb980d8b696fa74087231ab09bda68fd536e8040e035674c6012cc49f59be873054fe72ab704410bdb34fb7b63f87bbea2784e15781d41788bcf962b934b2173b047c4e1a1b5794fe93cde04f3e31c99c8125f53e655ed538ebac8f62a0343cc77200544bc2bb6691bab50d1be12e1fb3ecd0270ad87d16a0354b35e3c5cd5e9b45956c858bf6f03ed10f2663510427f7128f5f0501b8428643e03b84ca04e58026407e129e9299cf80e1126fb53e4730986985750997c1b3bc72898dd7623a3ebd0b72382417c80a6e35bb873661e925296782a317a2fbef490a0746166ec39db1fd3040450be7b9441208f3fcf7749f6b8f3cd75462590192af9df7adb0e965ab1ea17228f85da2a981e1fa2e88506606eb9c59e75e41b33e6933e7c4b0145d5277ab15f665928e46882ee6f49ae442a3838a70f91e1ccbf640b15f84f7ad4e4f0f3773d6dbee44c332d7fd77b79afbea5def65b22b5312613dffa7140c1a0049ef2ed2f1e1d98ec784c588df66d9588283b180390c4c50286705079d77c53be91d767b6fffbb32fa88dece54300a2214fdba09b749714df2c7acc747c114c7d7a3f9b677bdfcf905450b19fd9b932147d1f048536b29d06863da2e3971716bba899dca31a404ab90c335af0231dd1dc4093d8536f9dba3324578859c0f43f03ad54c01c63b3b10420b42d98c7a50de32ad8807877bf18cf7756f149723f21f0091eda15e0a0aefc4241cdfc3fd542b3ac3b9176f7ad2545ff9a5235336e6beb4c468f3209ad712bd16a909ce4252ce8455b7fd167de6c314db04faf8cf8695fe77a53f35720b3fd6ead39fd5d1b08db76a6c01a30c95a0bb2373e1ad773c6e84b18bcdc51b0f3fb7a780e80233d8317b0bbf6b3faf47b5ffd7d91f9ab5700ff17a04e4f71b4ada07559a2d7bef30827a3f988211ef64c8850120fde8118841ebdaf8cdf3fc23d76ffd08b6688d2247590edf8f425354a2f8a82fc3bf13edcc1ada4dd1e245040096a5b2cbf295154ac3807cdaf9647f0bfed5eeb9464407782881ec36ec7f541b255880b4419071515e9e58ab5fa84eca3f8f4526a62b3e0dbad8bd4438317af1c31b5ab87c069d25d26f594a9ca927a965de1c540651fb527be5a845efe3e04a19f82821cb7d038ec8fb68fed7ef736e15ca5b898f3ca41010b2967f381eedeecef6d235577f0a53e84b6e1138009be2f95cea0e6976a30f24476d3b3c6809a48b1d403d48931a3ed96651c9e86605cdb99bb12bbb875e175daa17c1224c9c35f8765b80c6429b154454fb6f0fa91bf7fd909927adf53ff063e57a59134f0e6abc080948f812f5a1d01e524ad44f44276c41884c694aac61df00804b37fbc80980dc33db068d91aa26cb40a460e2e727aeb867e0140d0f34790110deb5d730daebf8c282193bd5f8ed63acc3dbea6ebd6cfd1f2cd9c7cf2fd8f2115c",
	.p_expected_output =
		"aab8b76572a544eaec4cd64bdb5c84f3c6674e9cea12e596afe88384"
};

ITEM_REGISTER(test_vector_hash_224_long_data,
	      test_vector_hash_t test_vector_SHA224_long) = {
	.digest_type = MBEDTLS_MD_SHA256,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.mode = NO_MODE,
	.chunk_length = 4096,
	.update_iterations = 256,
	.p_test_vector_name = TV_NAME("SHA224 message_len=1048576"),
	.p_input = flash_data_sha_224,
	.p_expected_output =
		"e52eaf626a37be967b86ed5e6381ee2129bb3940613141c698439d55"
};

ITEM_REGISTER(test_vector_hash_224_long_data,
	      test_vector_hash_t test_vector_SHA224_long_flash) = {
	.digest_type = MBEDTLS_MD_SHA256,
	.expected_err_code = 0,
	.expected_result = EXPECTED_TO_PASS,
	.mode = DO_MEMCPY,
	.chunk_length = 4096,
	.update_iterations = 256,
	.p_test_vector_name = TV_NAME("SHA224 flash memcpy message_len=1048576"),
	.p_input = flash_data_sha_224,
	.p_expected_output =
		"e52eaf626a37be967b86ed5e6381ee2129bb3940613141c698439d55"
};
